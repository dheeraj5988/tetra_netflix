# Tetra Netflix - Complete Setup & Usage Guide

## ğŸ¯ What This Project Does

**Tetra Netflix** is a web application that automatically fetches Netflix verification codes and household location update links from your Gmail inbox.

- **Netflix Codes**: TV device verification codes (4-8 digits)
- **Household Links**: One-click household location update links

## ğŸ“‹ Prerequisites

### Required
- **Node.js 16+** and **npm/pnpm** installed
- **Google Gmail API** credentials (OAuth2)
- Gmail account with Netflix emails
- Modern web browser

### Optional
- Git for version control
- Docker (for deployment)

## ğŸ”§ Setup Instructions

### Step 1: Clone or Download Repository

```bash
git clone https://github.com/dheeraj5988/tetra_netflix.git
cd tetra_netflix
```

### Step 2: Install Dependencies

```bash
npm install
# or
pnpm install
```

### Step 3: Set Up Google OAuth2 Credentials

To enable Gmail access, you need to create Google OAuth2 credentials:

#### 3a. Create Google Cloud Project
1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project named "Tetra Netflix"
3. Enable the **Gmail API**

#### 3b. Create OAuth2 Credentials
1. Go to **Credentials** â†’ **Create Credentials** â†’ **OAuth Client ID**
2. Choose **Desktop Application**
3. Download the JSON file (you'll need `client_id` and `client_secret`)

#### 3c. Get Refresh Token
Run this command to get a refresh token:

```bash
npm run get-token
# or manually:
# node scripts/get-refresh-token.js
```

This will:
- Open a browser to authorize your Gmail account
- Generate a `GMAIL_REFRESH_TOKEN`
- Display all credentials you need

### Step 4: Configure Environment Variables

Create a `.env.local` file in the project root:

```bash
# .env.local
GOOGLE_CLIENT_ID=your_client_id_here
GOOGLE_CLIENT_SECRET=your_client_secret_here
GMAIL_REFRESH_TOKEN=your_refresh_token_here
GMAIL_USER=me
NODE_ENV=development
```

**Where to find these:**
- `GOOGLE_CLIENT_ID` and `GOOGLE_CLIENT_SECRET`: Google Cloud Console credentials
- `GMAIL_REFRESH_TOKEN`: Generated by the script in Step 3c
- `GMAIL_USER`: Leave as "me" (searches authenticated user's inbox)

### Step 5: Verify Installation

```bash
# Check if all dependencies are installed
npm list googleapis react next

# Output should show:
# â”œâ”€â”€ googleapis@164.0.0
# â”œâ”€â”€ react@19.1.0
# â””â”€â”€ next@15.5.4
```

## ğŸš€ Running the Application

### Development Mode

```bash
npm run dev
```

The application will start on `http://localhost:3000`

### Production Build

```bash
npm run build
npm start
```

## ğŸ“– How to Use

### From the Web Interface

1. **Open the website** at `http://localhost:3000`
2. **Enter your email** (the Gmail account connected via OAuth)
3. **Click "Fetch Now"**
4. **Wait** (usually 2-10 seconds)

### Results

#### âœ… If a Code is Found
- Large, bold number displayed
- "Copy Code" button to copy to clipboard
- Code expires in 15 minutes

#### âœ… If a Household Link is Found
- Purple box with the link
- "Approve Update" button opens in new tab
- Click to verify your household location

#### âŒ If Nothing Found
- Error message explains why
- Common reasons:
  - No Netflix emails in inbox
  - Gmail credentials not configured
  - Wrong email account

## ğŸ” Security Considerations

### âœ… What's Secure
- OAuth2 authentication (no passwords stored)
- Credentials stored in `.env.local` (never in code)
- Gmail API uses secure HTTPS connections
- User's inbox never leaves Google servers

### âš ï¸ Security Best Practices
1. **Never commit `.env.local` to git** (add to `.gitignore`)
2. **Use a dedicated Gmail account** or app-specific password
3. **Rotate tokens** every 3-6 months
4. **Don't share your refresh token** with anyone
5. **Run on HTTPS** if deployed online

### ğŸ”’ Privacy
- We never store your emails or codes
- Only the code/link is extracted and displayed
- Nothing is logged or sent to external servers

## ğŸ› Troubleshooting

### Issue: "Email address is required"
**Solution:** Make sure you entered a valid email address

### Issue: "Invalid email format"
**Solution:** Check that your email is formatted correctly (name@domain.com)

### Issue: "No Netflix code or link found"
**Solutions:**
- Make sure you have Netflix emails in your Gmail inbox
- Check that Gmail credentials in `.env.local` are correct
- Try a different Gmail account
- Wait 30 seconds for Gmail to index new emails

### Issue: "Failed to load email service"
**Solutions:**
- Verify `GOOGLE_CLIENT_ID` and `GOOGLE_CLIENT_SECRET` are correct
- Check `.env.local` file exists in project root
- Restart the dev server: `npm run dev`
- Test credentials: `npm run test-gmail`

### Issue: "Module not found: googleapis"
**Solution:** Reinstall dependencies:
```bash
rm -rf node_modules package-lock.json
npm install
```

### Issue: Site shows "Searching..." forever
**Solutions:**
- Check browser console for errors (F12)
- Verify `.env.local` file is loaded
- Restart dev server
- Check network tab in DevTools for API response

## ğŸ“ Project Structure

```
tetra_netflix/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx              # Main UI (improved with code display)
â”‚   â”œâ”€â”€ layout.tsx            # Layout wrapper
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ fetch-code/
â”‚           â””â”€â”€ route.ts      # API endpoint (handles email fetch)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ gmail.ts              # Gmail API integration
â”‚   â””â”€â”€ utils.ts              # Utility functions
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ui/                   # Reusable UI components
â”œâ”€â”€ .env.local                # Secrets (not in git)
â”œâ”€â”€ package.json              # Dependencies
â””â”€â”€ tsconfig.json             # TypeScript config
```

## ğŸ“ Development Commands

```bash
# Start dev server
npm run dev

# Build for production
npm run build

# Run production build locally
npm start

# Run linter
npm run lint

# Test Gmail credentials (if script exists)
npm run test-gmail

# Get new refresh token
npm run get-token
```

## ğŸŒ Deployment

### Vercel (Recommended)

```bash
# Install Vercel CLI
npm install -g vercel

# Deploy
vercel
```

**Important:** Set environment variables in Vercel dashboard:
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `GMAIL_REFRESH_TOKEN`
- `NODE_ENV=production`

### Docker

```bash
# Build image
docker build -t tetra-netflix .

# Run container
docker run -p 3000:3000 \
  -e GOOGLE_CLIENT_ID=xxx \
  -e GOOGLE_CLIENT_SECRET=xxx \
  -e GMAIL_REFRESH_TOKEN=xxx \
  tetra-netflix
```

### Heroku

```bash
heroku create tetra-netflix
heroku config:set GOOGLE_CLIENT_ID=xxx
heroku config:set GOOGLE_CLIENT_SECRET=xxx
heroku config:set GMAIL_REFRESH_TOKEN=xxx
git push heroku main
```

## ğŸ“š API Reference

### Endpoint: `POST /api/fetch-code`

**Request:**
```json
{
  "email": "user@gmail.com"
}
```

**Response (Code Found):**
```json
{
  "success": true,
  "type": "code",
  "code": "5847",
  "meta": { "id": "abc123" }
}
```

**Response (Link Found):**
```json
{
  "success": true,
  "type": "link",
  "link": "https://www.netflix.com/account/update-primary-location?...",
  "meta": { "id": "def456" }
}
```

**Response (Error):**
```json
{
  "success": false,
  "message": "No Netflix code or household update link found..."
}
```

## ğŸ¤ Contributing

Contributions welcome! Please:
1. Fork the repository
2. Create a feature branch (`git checkout -b feature/your-feature`)
3. Commit changes (`git commit -m "Add feature"`)
4. Push branch (`git push origin feature/your-feature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see `LICENSE` file for details

## ğŸ’¬ Support

For issues or questions:
- Open an issue on GitHub
- Check this guide's troubleshooting section
- Review the code comments for implementation details

## âœ¨ Features

- âœ… Real-time Netflix code fetching
- âœ… Household location update link detection
- âœ… Beautiful, responsive UI
- âœ… Secure OAuth2 authentication
- âœ… Email validation
- âœ… Copy-to-clipboard functionality
- âœ… Error handling & helpful messages
- âœ… Dark-mode ready (TailwindCSS)

## ğŸ‰ Next Steps

1. âœ… Complete setup above
2. âœ… Test with your first email
3. âœ… Deploy to production (Vercel/Docker/Heroku)
4. âœ… Share feedback or contribute improvements

---

**Made with â¤ï¸ by dheeraj5988**

Last Updated: November 2025
